---
// src/components/blog/ListItem.astro
import type { ImageMetadata } from 'astro'
import Image from '~/components/common/Image.astro'
import { getPermalink } from '~/utils/permalinks'
import { getFormattedDate } from '~/utils/utils'

const { post } = Astro.props
const isString = typeof post.image === 'string'
---

<a href={getPermalink(post.permalink, 'post')} class="group block rounded-xl border border-gray-200 dark:border-slate-800 overflow-hidden bg-white/60 dark:bg-slate-900/60 backdrop-blur hover:shadow-xl hover:-translate-y-0.5 transition">
  <div class="relative w-full overflow-hidden aspect-[16/9] bg-gray-200/60 dark:bg-slate-800">
    {
      post.image && (
        isString ? (
          <img
            src={post.image as string}
            alt={post?.excerpt || post.title || ''}
            class="absolute inset-0 h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.03]"
            loading="lazy"
            decoding="async"
          />
        ) : (
          <Image
            src={post.image as ImageMetadata}
            alt={post?.excerpt || post.title || ''}
            class="absolute inset-0 h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.03]"
            widths={[400, 800, 1200]}
            sizes="(min-width: 768px) 50vw, 100vw"
            loading="lazy"
            decoding="async"
          />
        )
      )
    }
  </div>

  <div class="p-4">
    <h3 class="text-lg font-semibold leading-snug group-hover:text-primary transition-colors">{post.title}</h3>
    {post.excerpt && <p class="mt-1 text-sm text-muted dark:text-slate-400 line-clamp-2">{post.excerpt}</p>}
    <div class="mt-3 text-xs text-muted dark:text-slate-500">
      {post.publishDate && getFormattedDate(post.publishDate)}{post.author ? ` Â· ${post.author}` : ''}
    </div>
  </div>
</a>
